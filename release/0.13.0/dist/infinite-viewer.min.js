/*
Copyright (c) 2019 Daybrush
name: infinite-viewer
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/infinite-viewer.git
version: 0.13.0
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).InfiniteViewer=e()}(this,function(){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function o(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var a=function(){return(a=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function s(t){return t&&"object"==typeof t}var r=function(){return(r=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};var t=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(s(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(s(t))for(var n in t)this.off(n);else{var i,r;e?!(i=this._events[t])||-1<(r=function(t,e,n){void 0===n&&(n=-1);for(var i=t.length,r=0;r<i;++r)if(e(t[r],r,t))return r;return n}(i,function(t){return t.listener===e}))&&i.splice(r,1):this._events[t]=[]}else this._events={};return this},e.once=function(e,t){var n=this;return t&&this._addEvent(e,t,{once:!0}),new Promise(function(t){n._addEvent(e,t,{once:!0})})},e.emit=function(e,n){var i=this;void 0===n&&(n={});var t=this._events[e];if(!e||!t)return!0;var r=!1;return n.eventType=e,n.stop=function(){r=!0},n.currentTarget=this,function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}(t).forEach(function(t){t.listener(n),t.once&&i.off(e,t.listener)}),!r},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var i=this._events;i[t]=i[t]||[],i[t].push(r({listener:e},n))},t}(),l="function",c="object",h=['"',"'",'\\"',"\\'"],u={cm:function(t){return 96*t/2.54},mm:function(t){return 96*t/254},in:function(t){return 96*t},pt:function(t){return 96*t/72},pc:function(t){return 96*t/6},"%":function(t,e){return t*e/100},vw:function(t,e){return void 0===e&&(e=window.innerWidth),t/100*e},vh:function(t,e){return void 0===e&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return void 0===e&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return void 0===e&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function f(t,e,n,i){for(var r=n;r<i;++r){var o=e[r].trim();if(o===t)return r;var s=r;if("("===o?s=f(")",e,r+1,i):-1<h.indexOf(o)&&(s=f(o,e,r+1,i)),-1===s)break;r=s}return-1}function g(t){return function(t,e){for(var n=new RegExp("(\\s*"+(e||",")+"\\s*|\\(|\\)|\"|'|\\\\\"|\\\\'|\\s+)","g"),i=t.split(n).filter(Boolean),r=i.length,o=[],s=[],a=0;a<r;++a){var l=i[a].trim(),c=a;if("("===l)c=f(")",i,a+1,r);else{if(")"===l)throw new Error("invalid format");if(-1<h.indexOf(l))c=f(l,i,a+1,r);else if(l===e){s.length&&(o.push(s.join("")),s=[]);continue}}-1===c&&(c=r-1),s.push(i.slice(a,c+1).join("")),a=c}return s.length&&o.push(s.join("")),o}(t,",")}function b(){return Date.now?Date.now():(new Date).getTime()}function S(t,e){var n,i=function(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],i=e[2];return{prefix:n,unit:e[3],value:parseFloat(i)}}(t),r=i.value,o=i.unit;if((n=e)&&typeof n===c){var s=e[o];if(s){if(typeof s===l)return s(r);if(u[o])return u[o](r,s)}}else if("%"===o)return r*e/100;return u[o]?u[o](r):r}function p(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function E(t,e,n,i){t.addEventListener(e,n,i)}function y(t,e,n){t.removeEventListener(e,n)}var d=function(t,e){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var z=function(){return(z=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function n(t){return 180*(e=[t[0].clientX,t[0].clientY],n=[t[1].clientX,t[1].clientY],i=n[0]-e[0],r=n[1]-e[1],(0<=(o=Math.atan2(r,i))?o:o+2*Math.PI)/Math.PI);var e,n,i,r,o}function x(t){return t.touches?function(t){for(var e=Math.min(t.length,2),n=[],i=0;i<e;++i)n.push(w(t[i]));return n}(t.touches):[w(t)]}function v(t,e,n){var i=n.length,r=C(t,i),o=r.clientX,s=r.clientY,a=r.originalClientX,l=r.originalClientY,c=C(e,i),h=c.clientX,u=c.clientY,f=C(n,i);return{clientX:a,clientY:l,deltaX:o-h,deltaY:s-u,distX:o-f.clientX,distY:s-f.clientY}}function m(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function w(t){return{clientX:t.clientX,clientY:t.clientY}}function C(t,e){void 0===e&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},i=0;i<e;++i){var r=t[i];n.originalClientX+="originalClientX"in r?r.originalClientX:r.clientX,n.originalClientY+="originalClientY"in r?r.originalClientY:r.clientY,n.clientX+=r.clientX,n.clientY+=r.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var T=function(){function t(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}var e=t.prototype;return e.addClients=function(t){void 0===t&&(t=this.prevClients);var e=this.getPosition(t),n=e.deltaX,i=e.deltaY;return this.movement+=Math.sqrt(n*n+i*i),this.prevClients=t,e},e.getAngle=function(t){return void 0===t&&(t=this.prevClients),n(t)},e.getRotation=function(t){return void 0===t&&(t=this.prevClients),n(t)-n(this.startClients)},e.getPosition=function(t){return v(t||this.prevClients,this.prevClients,this.startClients)},e.getPositions=function(n){void 0===n&&(n=this.prevClients);var i=this.prevClients;return this.startClients.map(function(t,e){return v([n[e]],[i[e]],[t])})},e.getMovement=function(t){var e=this.movement;if(!t)return e;var n=C(t,this.length),i=C(this.prevClients,this.length),r=n.clientX-i.clientX,o=n.clientY-i.clientY;return Math.sqrt(r*r+o*o)+e},e.getDistance=function(t){return void 0===t&&(t=this.prevClients),m(t)},e.getScale=function(t){return void 0===t&&(t=this.prevClients),m(t)/m(this.startClients)},e.move=function(e,n){this.startClients.forEach(function(t){t.clientX-=e,t.clientY-=n}),this.prevClients.forEach(function(t){t.clientX-=e,t.clientY-=n})},t}(),D=["textarea","input"],X=function(l){function t(){this.constructor=e}var e,n;function i(t,e){void 0===e&&(e={});var w=l.call(this)||this;w.options={},w.flag=!1,w.pinchFlag=!1,w.datas={},w.isDrag=!1,w.isPinch=!1,w.isMouse=!1,w.isTouch=!1,w.clientStores=[],w.targets=[],w.prevTime=0,w.doubleFlag=!1,w.onDragStart=function(t,e){if(void 0===e&&(e=!0),w.flag||!1!==t.cancelable){var n=w.options,i=n.container,r=n.pinchOutside,o=n.preventRightClick,s=n.preventDefault,a=n.checkInput,l=w.isTouch,c=!w.flag;if(c){var h,u=document.activeElement,f=t.target,g=f.tagName.toLowerCase(),p=-1<D.indexOf(g),d=f.isContentEditable;if(p||d){if(a||u===f)return!1;if(u&&d&&u.isContentEditable&&u.contains(f))return!1}else{(s||"touchstart"===t.type)&&u&&(h=u.tagName,(u.isContentEditable||-1<D.indexOf(h))&&u.blur())}if(w.clientStores=[new T(x(t))],w.flag=!0,w.isDrag=!1,w.datas={},o&&(3===t.which||2===t.button))return w.initDrag(),!1;w.doubleFlag=b()-w.prevTime<200,!1===w.emit("dragStart",z({datas:w.datas,inputEvent:t,isTrusted:e,isDouble:w.doubleFlag},w.getCurrentStore().getPosition()))&&w.initDrag(),w.flag&&s&&t.preventDefault()}if(!w.flag)return!1;var v,m=0;if(c&&l&&r&&(m=setTimeout(function(){E(i,"touchstart",w.onDragStart,{passive:!1})})),!c&&l&&r&&y(i,"touchstart",w.onDragStart),w.flag&&((v=t).touches&&2<=v.touches.length)){if(clearTimeout(m),c&&t.touches.length!==t.changedTouches.length)return;w.pinchFlag||w.onPinchStart(t)}}},w.onDrag=function(t,e){var n,i;w.flag&&(n=x(t),i=w.moveClients(n,t,!1),(w.pinchFlag||i.deltaX||i.deltaY)&&w.emit("drag",z({},i,{isScroll:!!e,inputEvent:t})),w.pinchFlag&&w.onPinch(t,n),w.getCurrentStore().addClients(n))},w.onDragEnd=function(t){var e,n,i,r,o,s;w.flag&&(n=(e=w.options).pinchOutside,i=e.container,w.isTouch&&n&&y(i,"touchstart",w.onDragStart),w.flag=!1,r=w.getCurrentStore().getPosition(),o=b(),s=!w.isDrag&&w.doubleFlag,w.prevTime=w.isDrag||s?0:o,w.emit("dragEnd",z({datas:w.datas,isDouble:s,isDrag:w.isDrag,inputEvent:t},r)),w.pinchFlag&&w.onPinchEnd(t),w.clientStores=[])},w.onBlur=function(){w.onDragEnd()};var n=[].concat(t);w.options=z({checkInput:!1,container:1<n.length?window:n[0],preventRightClick:!0,preventDefault:!0,checkWindowBlur:!1,pinchThreshold:0,events:["touch","mouse"]},e);var i,r=w.options,o=r.container,s=r.events,a=r.checkWindowBlur;return w.isTouch=-1<s.indexOf("touch"),w.isMouse=-1<s.indexOf("mouse"),w.targets=n,w.isMouse&&(n.forEach(function(t){E(t,"mousedown",w.onDragStart)}),E(o,"mousemove",w.onDrag),E(o,"mouseup",w.onDragEnd),E(o,"contextmenu",w.onDragEnd)),a&&E(window,"blur",w.onBlur),w.isTouch&&(i={passive:!1},n.forEach(function(t){E(t,"touchstart",w.onDragStart,i)}),E(o,"touchmove",w.onDrag,i),E(o,"touchend",w.onDragEnd,i),E(o,"touchcancel",w.onDragEnd,i)),w}d(e=i,n=l),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t);var r=i.prototype;return r.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(t,e){return t+e.movement},0)},r.isDragging=function(){return this.isDrag},r.isFlag=function(){return this.flag},r.isPinchFlag=function(){return this.pinchFlag},r.isDoubleFlag=function(){return this.doubleFlag},r.isPinching=function(){return this.isPinch},r.scrollBy=function(t,e,n,i){void 0===i&&(i=!0),this.flag&&(this.clientStores[0].move(t,e),i&&this.onDrag(n,!0))},r.move=function(t,e){var i=t[0],r=t[1],n=this.getCurrentStore().prevClients;return this.moveClients(n.map(function(t){var e=t.clientX,n=t.clientY;return{clientX:e+i,clientY:n+r,originalClientX:e,originalClientY:n}}),e,!0)},r.triggerDragStart=function(t){this.onDragStart(t,!1)},r.setEventDatas=function(t){var e=this.datas;for(var n in t)e[n]=t[n];return this},r.getEventDatas=function(){return this.datas},r.unset=function(){var e=this,t=this.targets,n=this.options.container;this.off(),y(window,"blur",this.onBlur),this.isMouse&&(t.forEach(function(t){y(t,"mousedown",e.onDragStart)}),y(n,"mousemove",this.onDrag),y(n,"mouseup",this.onDragEnd),y(n,"contextmenu",this.onDragEnd)),this.isTouch&&(t.forEach(function(t){y(t,"touchstart",e.onDragStart)}),y(n,"touchstart",this.onDragStart),y(n,"touchmove",this.onDrag),y(n,"touchend",this.onDragEnd),y(n,"touchcancel",this.onDragEnd))},r.onPinchStart=function(t){var e,n=this.options.pinchThreshold;this.isDrag&&this.getMovement()>n||(e=new T(x(t)),this.pinchFlag=!0,this.clientStores.splice(0,0,e),!1===this.emit("pinchStart",z({datas:this.datas,angle:e.getAngle(),touches:this.getCurrentStore().getPositions()},e.getPosition(),{inputEvent:t}))&&(this.pinchFlag=!1))},r.onPinch=function(t,e){var n;!this.flag||!this.pinchFlag||e.length<2||(n=this.getCurrentStore(),this.isPinch=!0,this.emit("pinch",z({datas:this.datas,movement:this.getMovement(e),angle:n.getAngle(e),rotation:n.getRotation(e),touches:n.getPositions(e),scale:n.getScale(e),distance:n.getDistance(e)},n.getPosition(e),{inputEvent:t})))},r.onPinchEnd=function(t){var e,n;this.pinchFlag&&(e=this.isPinch,this.isPinch=!1,this.pinchFlag=!1,n=this.getCurrentStore(),this.emit("pinchEnd",z({datas:this.datas,isPinch:e,touches:n.getPositions()},n.getPosition(),{inputEvent:t})),this.isPinch=!1,this.pinchFlag=!1)},r.initDrag=function(){this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1},r.getCurrentStore=function(){return this.clientStores[0]},r.moveClients=function(t,e,n){var i=this.getCurrentStore()[n?"addClients":"getPosition"](t);return this.isDrag=!0,z({datas:this.datas},i,{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:e})},i}(t);var e=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0};function Y(t,e,n,i){var r,o,s=document.createElement("style");return s.setAttribute("type","text/css"),s.setAttribute("data-styled-id",t),n.nonce&&s.setAttribute("nonce",n.nonce),s.innerHTML=(r=t,o=e,n.original?o:o.replace(/([^};{\s}][^};{]*|^\s*){/gm,function(t,e){var n=e.trim();return(n?g(n):[""]).map(function(t){var e=t.trim();return 0===e.indexOf("@")?e:-1<e.indexOf(":global")?e.replace(/\:global/g,""):-1<e.indexOf(":host")?""+e.replace(/\:host/g,"."+r):e?"."+r+" "+e:"."+r}).join(", ")+" {"})),(i||document.head||document.body).appendChild(s),s}function O(t,e){for(var n=t.length,i=0;i<n;++i)if(e(t[i],i))return!0;return!1}function P(t,e){for(var n=t.length,i=0;i<n;++i)if(e(t[i],i))return t[i];return null}function M(t,e){try{return new RegExp(t,"g").exec(e)}catch(t){return null}}function A(t){return t.replace(/_/g,".")}function W(t,r){var o=null,s="-1";return O(t,function(t){var e,n,i=M("("+t.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",r);return i&&!t.brand&&(o=t,s=i[3]||"-1",t.versionAlias?s=t.versionAlias:t.versionTest&&(e=t.versionTest.toLowerCase(),n=M("("+e+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",r),s=(n?n[3]:"")||s),s=A(s),1)}),{preset:o,version:s}}function j(t,n){return P(t,function(t){var e=t.brand;return M(""+n.test,e.toLowerCase())})}var F=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],L=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",brand:!0}],_=[{test:"applewebkit",id:"webkit"}],H=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],B=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"mac os x",id:"mac"},{test:"android",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function R(t){var e=function(t){var e=t;if(void 0===e){if("undefined"==typeof navigator||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}(t),n=!!/mobi/g.exec(e),i={name:"unknown",version:"-1",majorVersion:-1,webview:!!W(H,e).preset,chromium:!!W(L,e).preset,webkit:!1},r={name:"unknown",version:"-1",majorVersion:-1},o=W(F,e),s=o.preset,a=o.version,l=W(B,e),c=l.preset,h=l.version;return i.webkit=!i.chromium&&!!W(_,e).preset,c&&(r.name=c.id,r.version=h,r.majorVersion=parseInt(h,10)),s&&(i.name=s.id,i.version=a,i.webview&&"ios"===r.name&&"safari"!==i.name&&(i.webview=!1)),i.majorVersion=parseInt(i.version,10),{browser:i,os:r,isMobile:n,isHints:!1}}var N,k,V,q,I,Z,G,K,$,U,J,Q,tt,et,nt,it="safari"===(void 0===N&&function(){if("undefined"!=typeof navigator&&navigator&&navigator.userAgentData){var t=navigator.userAgentData,e=t.brands||t.uaList;return e&&e.length}}()?(I=navigator.userAgentData,Z=(I.uaList||I.brands).slice(),G=I.mobile||!1,K=Z[0],$={name:K.brand,version:K.version,majorVersion:-1,webkit:!1,webview:O(H,function(t){return j(Z,t)}),chromium:O(L,function(t){return j(Z,t)})},U={name:"unknown",version:"-1",majorVersion:-1},$.webkit=!$.chromium&&O(_,function(t){return j(Z,t)}),k&&(V=k.platform.toLowerCase(),q=P(B,function(t){return new RegExp(""+t.test,"g").exec(V)}),U.name=q?q.id:V,U.version=k.platformVersion),O(F,function(t){var e=j(Z,t);return e&&($.name=t.id,$.version=k?k.uaFullVersion:e.version,1)}),"Linux armv8l"===navigator.platform?U.name="android":$.webkit&&(U.name=G?"ios":"mac"),"ios"===U.name&&$.webview&&($.version="-1"),U.version=A(U.version),$.version=A($.version),U.majorVersion=parseInt(U.version,10),$.majorVersion=parseInt($.version,10),{browser:$,os:U,isMobile:G,isHints:!0}):R(N)).browser.name,rt="infinite-viewer-",ot=rt+"wrapper",st=rt+"scroll-area",at=rt+"horizontal-scroll-bar",lt=rt+"vertical-scroll-bar",ct=rt+"scroll-thumb",ht=(nt=rt,J="\n{\n    position: relative;\n    overscroll-behavior: none;\n}\n.wrapper {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    top: 0;\n    left: 0;\n    will-change: scroll-position;\n}\n.wrapper::-webkit-scrollbar {\n    display: none;\n}\n.scroll-area {\n    position:absolute;\n    top:0;\n    left:0;\n    transform-origin: 0 0;\n}\n.scroll-bar {\n    position:absolute;\n    width: 10px;\n    height: 10px;\n    box-sizing: border-box;\n    right: 0;\n    bottom: 0;\n    overflow: hidden;\n}\n.horizontal-scroll-bar {\n    width: 100%;\n    height: 14px;\n}\n.vertical-scroll-bar {\n    height: 100%;\n    width: 14px;\n}\n.scroll-thumb {\n    position:relative;\n    opacity: 0.7;\n    background: #333;\n    border-radius: 3px;\n    left: 0px;\n    top: 0px;\n    z-index: 10;\n    width: 6px;\n    height: 6px;\n    transition: all ease 0.2s;\n}\n.horizontal-scroll-bar .scroll-thumb {\n    margin: 4px 0px;\n    transition-property: margin, height, border-radius;\n}\n.vertical-scroll-bar .scroll-thumb {\n    margin: 0px 4px;\n    transition-property: margin, width, border-radius;\n}\n.horizontal-scroll-bar:hover .scroll-thumb {\n    height: 10px;\n    margin: 2px 0px;\n    border-radius: 5px;\n}\n.vertical-scroll-bar:hover .scroll-thumb {\n    width: 10px;\n    margin: 0px 2px;\n    border-radius: 5px;\n}\n".replace(/([^}{]*){/gm,function(t,e){return e.replace(/\.([^{,\s\d.]+)/g,"."+nt+"$1")+"{"}),{className:tt="rCS"+e(J).toString(36),inject:function(t,e){void 0===e&&(e={});var n,i=function(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(t),r=0===et;return(i||r)&&(n=Y(tt,J,e,i)),r&&(Q=n),i||++et,{destroy:function(){i?(t.removeChild(n),n=null):(0<et&&--et,0===et&&Q&&(Q.parentNode.removeChild(Q),Q=null))}}}}),ut={margin:500,threshold:100,zoom:1,rangeX:[-1/(et=0),1/0],rangeY:[-1/0,1/0],rangeOffsetX:[0,0],rangeOffsetY:[0,0],wrapperElement:null,scrollAreaElement:null,horizontalScrollElement:null,verticalScrollElement:null,usePinch:!1,pinchThreshold:30,cspNonce:"",maxPinchWheel:1/0,wheelScale:.01,displayHorizontalScroll:!0,displayVerticalScroll:!0,useTransform:!0,useForceWheel:!1,zoomOffsetX:"50%",zoomOffsetY:"50%",translateZ:0},ft=ht.className,gt=["margin","threshold","zoomOffsetX","zoomOffsetY","zoom","rangeX","rangeY","rangeOffsetX","rangeOffsetY","usePinch","pinchThreshold","maxPinchWheel","wheelScale","displayVerticalScroll","displayHorizontalScroll","useForceWheel","translateZ"],pt=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}(gt,["cspNonce","wrapperElement","scrollAreaElement","verticalScrollElement","horizontalScrollElement"]),dt={margin:Number,threshold:Number,zoomOffsetX:String,zoomOffsetY:String,zoom:Number,translateZ:Number,wrapperElement:Object,scrollAreaElement:Object,verticalScrollElement:Object,horizontalScrollElement:Object,rangeX:Array,rangeY:Array,rangeOffsetX:Array,rangeOffsetY:Array,pinchThreshold:Number,usePinch:Boolean,useForceWheel:Boolean,cspNonce:String,maxPinchWheel:Number,wheelScale:Number,displayHorizontalScroll:Boolean,displayVerticalScroll:Boolean,useTransform:Boolean};function vt(t,e){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return Math.abs(n/e)}function mt(t){return Math.abs(t)}function wt(t,e,n,i,r){return[r||isFinite(n[0])?n[0]:Math.min(-1,Math.floor(t/e))*e-i,r||isFinite(n[1])?n[1]:Math.max(1,Math.ceil(t/e))*e+i]}var bt=function(r){function t(t,e){var a=r.call(this)||this;a.type=t,a.isAppend=!1,a.pos=0,a.size=0,a.scrollSize=0,a.isHorizontal=!1,a.onWheel=function(t){var e=a.isHorizontal?t.deltaX:t.deltaY;e&&t.preventDefault(),a.trigger("scroll",{delta:e})};var n,l="horizontal"===t,i=e;return e?n=e.querySelector("."+ct):(i=document.createElement("div"),n=document.createElement("div"),i.insertBefore(n,null),a.isAppend=!0),p(i,l?at:lt),p(i,"infinite-viewer-scroll-bar"),p(n,ct),a.thumbElement=n,a.barElement=i,a.isHorizontal=l,a.gesto=new X(i,{container:window}).on("dragStart",function(s){var t=s.inputEvent.target,e=s.datas,n=a.thumbElement===t;n||setTimeout(function(){requestAnimationFrame(function(){var t,e,n=a.thumbElement.getBoundingClientRect(),i=n[l?"left":"top"],r=i+n[l?"width":"height"],o=s[l?"clientX":"clientY"];i<=o&&o<=r||(e=(t=a.size)*t/a.scrollSize,a.scrollBy(i<o?e:-e))})},100),e.isThumb=n,s.inputEvent.stopPropagation(),s.inputEvent.preventDefault()}).on("drag",function(t){t.datas.isThumb&&a.scrollBy(a.isHorizontal?t.deltaX:t.deltaY)}),E(a.barElement,"wheel",a.onWheel,{passive:!1}),a}o(t,r);var e=t.prototype;return e.scrollBy=function(t){var e=t/this.size;this.trigger("scroll",{delta:this.scrollSize*e})},e.render=function(t,e,n,i){this.pos=e,this.size=n,this.scrollSize=i;var r=t&&n<i?"block":"none",o=this.isHorizontal?["X","width"]:["Y","height"],s=o[0],a=o[1];this.barElement.style.cssText="display: "+r+";",this.thumbElement.style.cssText+=a+": "+n*n/i+"px;transform: translate"+s+"("+e/i*n+"px)"},e.destroy=function(){y(this.barElement,"wheel",this.onWheel),this.gesto.off(),this.off()},t}(t),St=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(function(i){function t(t,e,n){void 0===n&&(n={});var h=i.call(this)||this;return h.containerElement=t,h.viewportElement=e,h.offsetX=0,h.offsetY=0,h.containerWidth=0,h.containerHeight=0,h.viewportWidth=0,h.viewportHeight=0,h.scrollLeft=0,h.scrollTop=0,h.timer=0,h.tempScale=1,h.dragFlag=!1,h.isLoop=!1,h.resize=function(){var t=h.containerElement,e=t.offsetWidth,n=t.offsetHeight,i=h.viewportElement,r=i.offsetWidth,o=i.offsetHeight;h.containerWidth=e,h.containerHeight=n,h.viewportWidth=r,h.viewportHeight=o},h.onScroll=function(){var t=h.wrapperElement,e=t.scrollLeft,n=t.scrollTop,i=h.zoom,r=void 0===i?ut.zoom:i,o=e-h.scrollLeft,s=n-h.scrollTop,a=h.getScrollLeft(),l=h.getScrollTop();h.isLoop&&(h.isLoop=!1),h.scrollLeft=e,h.scrollTop=n,h.scrollTo(a+o/r,l+s/r)},h.onWheel=function(t){var e=h.options,n=e.maxPinchWheel||1/0;if(t.ctrlKey){var i=0<=(c=t.deltaY)?1:-1,r=Math.min(n,Math.abs(c)),o=-(c=i*r),s=Math.max(1+o*(e.wheelScale||.01),1e-6);h.trigger("pinch",{distance:r,scale:s,rotation:0,zoom:h.zoom*s,inputEvent:t,isWheel:!0})}else{if(!it&&!e.useForceWheel)return;var a=h.zoom,l=t.deltaX,c=t.deltaY;t.shiftKey&&!l&&(l=c,c=0),h.scrollBy(l/a,c/a)}t.preventDefault()},h.onGestureStart=function(t){h.tempScale=h.zoom,t.preventDefault()},h.onGestureChange=function(t){var e;t.preventDefault(),!h.gesto.isFlag()&&h.tempScale?(e=t.scale,h.trigger("pinch",{distance:0,scale:e,rotation:t.rotation,zoom:h.tempScale*e,inputEvent:t,isWheel:!0})):h.tempScale=0},h.options=a(a({},ut),n),h.init(),h}o(t,i);var n,r,e=t.prototype;return e.getContainer=function(){return this.containerElement},e.getViewport=function(){return this.viewportElement},e.getWrapper=function(){return this.wrapperElement},e.geScrollArea=function(){return this.scrollAreaElement},e.destroy=function(){this.off(),this.gesto.unset(),this.verticalScrollbar.destroy(),this.horizontalScrollbar.destroy(),this.injectResult.destroy();var t=this.containerElement;y(window,"resize",this.resize),y(this.wrapperElement,"scroll",this.onScroll),y(t,"wheel",this.onWheel),y(t,"tgesturestart",this.onGestureStart),y(t,"gesturechange",this.onGestureChange),this.gesto=null,this.injectResult=null,this.containerElement=null,this.viewportElement=null,this.options=null},e.getScrollTop=function(t){return this.scrollTop/this.zoom+this.offsetY+(t?mt(this.getRangeY()[0]):0)},e.getScrollLeft=function(t){return this.scrollLeft/this.zoom+this.offsetX+(t?mt(this.getRangeX()[0]):0)},e.getScrollWidth=function(t){var e=this.getRangeX(t);return this.containerWidth+mt(e[0])+mt(e[1])},e.getScrollHeight=function(t){var e=this.getRangeY(t);return this.containerHeight+mt(e[0])+mt(e[1])},e.scrollCenter=function(){this.resize();var t=this.zoom,e=-(this.containerWidth/t-this.viewportWidth)/2,n=-(this.containerHeight/t-this.viewportHeight)/2;return this.scrollTo(e,n)},e.scrollBy=function(t,e){return this.scrollTo(this.getScrollLeft()+t,this.getScrollTop()+e)},e.scrollTo=function(t,e){var n,i,r=this,o=this,s=o.zoom,a=void 0===s?ut.zoom:s,l=o.margin,c=void 0===l?ut.margin:l,h=o.threshold,u=void 0===h?ut.threshold:h,f=o.scrollLeft,g=o.scrollTop,p=this.getRangeX(!0,!0),d=p[0],v=p[1],m=this.getRangeY(!0,!0),w=m[0],b=m[1],S=Math.round(f),E=Math.round(g),y=this.getScrollAreaWidth(),z=this.getScrollAreaHeight(),x=t*a,C=e*a;x-u<=d?(S=n=Math.max(0,x-d),t=(d+n)/a):v<=x+u?(i=Math.max(0,v-x),S=y-i,t=(v-i)/a):S<u?S+=c:y-u<S&&(S-=c),C-u<=w?(E=n=Math.max(0,C-w),e=(w+n)/a):b<=C+u?(i=Math.max(0,b-C),E=z-i,e=(b-i)/a):E<u?E+=c:z-u<E&&(E-=c),S=Math.round(S),E=Math.round(E),this.scrollLeft=S,this.scrollTop=E,this.offsetX=Math.round(t-S/a),this.offsetY=Math.round(e-E/a),this.render();var T=this.getScrollLeft(),D=this.getScrollTop();return this.trigger("scroll",{scrollLeft:T,scrollTop:D}),Math.round(f)===S&&Math.round(g)===E||(this.isLoop=!0,this.move(S,E),requestAnimationFrame(function(){var t,e,n;r.isLoop&&(r.isLoop=!1,e=(t=r.wrapperElement).scrollLeft,n=t.scrollTop,r.scrollLeft=e,r.scrollTop=n,S===Math.round(e)&&E===Math.round(n)||r.scrollTo(T,D))}),!1)},e.setZoom=function(t){var e=this,n=e.containerWidth,i=e.containerHeight,r=e.zoomOffsetX,o=void 0===r?ut.zoomOffsetX:r,s=e.zoomOffsetY,a=void 0===s?ut.zoomOffsetY:s,l=e.zoom,c=this.getScrollLeft(),h=this.getScrollTop();this.options.zoom=t;var u=this.getScrollLeft(),f=this.getScrollTop(),g=S(""+o,n),p=S(""+a,i),d=c+g/l,v=h+p/l,m=u+g/t,w=f+p/t;this.scrollBy(d-m,v-w),this.render()},e.getRangeX=function(t,e){var n=this,i=n.rangeX,r=void 0===i?ut.rangeX:i,o=n.rangeOffsetX,s=void 0===o?ut.rangeOffsetX:o,a=n.margin,l=void 0===a?ut.margin:a,c=n.zoom,h=void 0===c?ut.zoom:c,u=n.threshold,f=wt(this.getScrollLeft(),l,r,u,e);return t?[f[0]*h+s[0],Math.max(this.viewportWidth*h-this.containerWidth,f[1]*h+s[1])]:[f[0]+s[0],f[1]+s[1]]},e.getRangeY=function(t,e){var n=this.rangeY,i=void 0===n?ut.rangeY:n,r=this.margin,o=void 0===r?ut.margin:r,s=this.zoom,a=void 0===s?ut.zoom:s,l=this.threshold,c=wt(this.getScrollTop(),o,i,l,e);return t?[c[0]*a,Math.max(this.viewportHeight*a-this.containerHeight,c[1]*a)]:c},e.init=function(){var r=this,t=this.containerElement,n=this.options,e=n.wrapperElement||t.querySelector("."+ot),i=n.scrollAreaElement||t.querySelector("."+st),o=n.horizontalScrollElement||t.querySelector("."+at),s=n.verticalScrollElement||t.querySelector("."+lt);e||((e=document.createElement("div")).insertBefore(this.viewportElement,null),t.insertBefore(e,null)),this.wrapperElement=e,i||(i=document.createElement("div"),e.insertBefore(i,e.firstChild)),this.scrollAreaElement=i,p(t,ft),p(e,ot),p(i,st),this.horizontalScrollbar=new bt("horizontal",o),this.verticalScrollbar=new bt("vertical",s),this.horizontalScrollbar.on("scroll",function(t){r.scrollBy(t.delta/r.zoom,0)}),this.verticalScrollbar.on("scroll",function(t){r.scrollBy(0,t.delta/r.zoom)}),this.horizontalScrollbar.isAppend&&t.insertBefore(this.horizontalScrollbar.barElement,null),this.verticalScrollbar.isAppend&&t.insertBefore(this.verticalScrollbar.barElement,null),this.injectResult=ht.inject(t,{nonce:this.options.cspNonce}),this.gesto=new X(t,{container:document.body,events:["touch"]}).on("dragStart",function(t){var e=t.inputEvent,n=t.datas,i=t.stop;r.pauseAnimation(),(r.dragFlag=!1)!==r.trigger("dragStart",{inputEvent:e})?(e.preventDefault(),n.startEvent=e):i()}).on("drag",function(t){var e;!r.options.usePinch||t.isPinch?(r.trigger("drag",a(a({},t),{inputEvent:t.inputEvent})),function(t){var e=t.deltaX,n=t.deltaY,i=t.datas,r=Date.now(),o=i.speed;if(!o)return i.speed=[0,0],i.time=r;var s=r-i.time;i.speed=[o[0]/2+e/s,o[1]/2+n/s]}(t),e=r.zoom,r.scrollBy(-t.deltaX/e,-t.deltaY/e)):!r.dragFlag&&t.movement>n.pinchThreshold&&(r.dragFlag=!0,r.trigger("abortPinch",{inputEvent:t.datas.startEvent||t.inputEvent}))}).on("dragEnd",function(t){r.trigger("dragEnd",{isDrag:t.isDrag,isDouble:t.isDouble,inputEvent:t.inputEvent}),r.startAnimation(t.datas.speed)}).on("pinchStart",function(t){var e=t.inputEvent,n=t.datas,i=t.stop;e.preventDefault(),r.pauseAnimation(),n.startZoom=r.zoom,!1===r.trigger("pinchStart",{inputEvent:e})&&i()}).on("pinch",function(t){r.trigger("pinch",{rotation:t.rotation,distance:t.distance,scale:t.scale,zoom:t.datas.startZoom*t.scale,inputEvent:t.inputEvent,isWheel:!1})}),E(e,"scroll",this.onScroll),E(window,"resize",this.resize),E(t,"wheel",this.onWheel,{passive:!1}),E(t,"gesturestart",this.onGestureStart,{passive:!1}),E(t,"gesturechange",this.onGestureChange,{passive:!1}),this.resize(),this.render(),this.scrollTo(0,0)},e.render=function(){var t=this.offsetX,e=this.offsetY,n=this.zoom,i=void 0===n?ut.zoom:n,r=this.translateZ,o=void 0===r?0:r,s=this.options.useTransform,a=void 0===s?ut.useTransform:s,l=-t*i,c=-e*i;this.scrollAreaElement.style.cssText="width:calc(100% + "+this.getScrollAreaWidth()+"px);height:calc(100% + "+this.getScrollAreaHeight()+"px);";var h=this.viewportElement.style;h.cssText+=!1===a?"position: relative; top: "+c+"px; left: "+l+"px;":"transform-origin: 0 0;transform:translate3d("+l+"px, "+c+"px, "+o+"px) scale("+i+");",this.renderScroll()},e.renderScroll=function(){var t=this.containerWidth,e=this.containerHeight,n=this.zoom,i=this.getScrollLeft(!0)*n,r=this.getScrollTop(!0)*n,o=this.getScrollWidth(!0),s=this.getScrollHeight(!0);this.horizontalScrollbar.render(this.displayHorizontalScroll,i,t,o),this.verticalScrollbar.render(this.displayVerticalScroll,r,e,s)},e.move=function(t,e){var n=this.wrapperElement;n.scrollLeft=t,n.scrollTop=e},e.startAnimation=function(t){var r,o,s,e,n,a,l,c,h=this;t&&(t[0]||t[1])&&(r=function(t){return 1-Math.pow(1-t,3)},o=vt(t,-6e-4),n=vt(e=t,-6e-4),s=[e[0]/2*n,e[1]/2*n],a=Date.now(),l=a,c=function(){var t=Date.now(),e=t-a;o<e&&(e=o);var n=r(e/o),i=r((l-a)/o);l=t,h.scrollBy(-s[0]*(n-i),-s[1]*(n-i)),o<=e||(h.timer=requestAnimationFrame(c))},this.timer=requestAnimationFrame(c))},e.pauseAnimation=function(){cancelAnimationFrame(this.timer)},e.getScrollAreaWidth=function(){var t=this.getRangeX(!0),e=t[0],n=t[1];return e||n?2*this.margin:0},e.getScrollAreaHeight=function(){var t=this.getRangeY(!0),e=t[0],n=t[1];return e||n?2*this.margin:0},function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;0<=a;a--)(r=t[a])&&(s=(o<3?r(s):3<o?r(e,n,s):r(e,n))||s);return 3<o&&s&&Object.defineProperty(e,n,s),s}([(n=gt,r=function(t,e){var n={enumerable:!0,configurable:!0,get:function(){return this.options[e]}},i=("set "+e).replace(/[\s-_]([a-z])/g,function(t,e){return e.toUpperCase()});t[i]?n.set=function(t){this[i](t)}:n.set=function(t){this.options[e]=t},Object.defineProperty(t,e,n)},function(t){var e=t.prototype;n.forEach(function(t){r(e,t)})})],t)}(t)),Et={__proto__:null,default:St,OPTIONS:pt,OPTION_TYPES:dt,PROPERTIES:gt,EVENTS:["scroll","abortPinch","dragStart","dragEnd","pinchStart","pinch"],METHODS:["getScrollLeft","getScrollTop","getScrollWidth","getScrollHeight","scrollTo","scrollBy","scrollCenter","getContainer","getViewport","getWrapper","setZoom","getRangeX","getRangeY"],CLASS_NAME:ft};for(var yt in Et)St[yt]=Et[yt];return St});
//# sourceMappingURL=infinite-viewer.min.js.map
