/*
Copyright (c) 2019 Daybrush
name: infinite-viewer
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/infinite-viewer.git
version: 0.16.0
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).InfiniteViewer=e()}(this,function(){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var h=function(){return(h=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function t(t,e,n){if(n||2===arguments.length)for(var i,r=0,o=e.length;r<o;r++)!i&&r in e||((i=i||Array.prototype.slice.call(e,0,r))[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var s="function",e="object",E="string",y=[{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"},{open:'\\"',close:'\\"'},{open:"\\'",close:"\\'"}],a={cm:function(t){return 96*t/2.54},mm:function(t){return 96*t/254},in:function(t){return 96*t},pt:function(t){return 96*t/72},pc:function(t){return 96*t/6},"%":function(t,e){return t*e/100},vw:function(t,e){return void 0===e&&(e=window.innerWidth),t/100*e},vh:function(t,e){return void 0===e&&(e=window.innerHeight),t/100*e},vmax:function(t,e){return void 0===e&&(e=Math.max(window.innerWidth,window.innerHeight)),t/100*e},vmin:function(t,e){return void 0===e&&(e=Math.min(window.innerWidth,window.innerHeight)),t/100*e}};function l(t){return t&&typeof t===e}function z(t,e,n,i,r){return C(t,e,n)?n:function(r,o,t,s,a){for(var l,e=t;e<s;++e){var n=function(t){var e=o[t].trim();if(e===r.close&&!C(r,o,t))return{value:t};var n=t,i=x(a,function(t){return t.open===e});if(i&&(n=z(i,o,t,s,a)),-1===n)return l=t,"break";l=t=n}(e);if(e=l,"object"==typeof n)return n.value;if("break"===n)break}return-1}(t,e,n+1,i,r)}function C(t,e,n){if(!t.ignore)return null;var i=e.slice(Math.max(n-3,0),n+3).join("");return new RegExp(t.ignore).exec(i)}function r(t,e){var n=typeof e===E?{separator:e}:e,i=n.separator,a=void 0===i?",":i,l=n.isSeparateFirst,c=n.isSeparateOnlyOpenClose,r=n.isSeparateOpenClose,h=void 0===r?c:r,o=n.openCloseCharacters,u=void 0===o?y:o,s=u.map(function(t){var e=t.open,n=t.close;return e===n?e:e+"|"+n}).join("|"),f=new RegExp("(\\s*"+a+"\\s*|"+s+"|\\s+)","g"),g=t.split(f).filter(Boolean),p=g.length,d=[],v=[];function m(){return v.length&&(d.push(v.join("")),v=[])}for(var w,b=0;b<p;++b){var S=function(t){var e,n,i=g[t].trim(),r=t,o=x(u,function(t){return t.open===i}),s=x(u,function(t){return t.close===i});if(o){if(-1!==(r=z(o,g,t,p,u))&&h)return m()&&l?(w=t,"break"):(d.push(g.slice(t,r+1).join("")),t=r,l?(w=t,"break"):(w=t,"continue"))}else{if(s&&!C(s,g,t))throw new Error("invalid format: "+s.close);if(e=i,!((""!==(n=a)&&" "!=n||""!==e&&" "!=e)&&e!==n||c))return m(),l?(w=t,"break"):(w=t,"continue")}-1===r&&(r=p-1),v.push(g.slice(t,r+1).join("")),w=t=r}(b),b=w;if("break"===S)break}return v.length&&d.push(v.join("")),d}function D(){return Date.now?Date.now():(new Date).getTime()}function c(t,e,n){void 0===n&&(n=-1);for(var i=t.length,r=0;r<i;++r)if(e(t[r],r,t))return r;return n}function x(t,e,n){var i=c(t,e);return-1<i?t[i]:n}function _(t,e){var n=function(t){var e=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t);if(!e)return{prefix:"",unit:"",value:NaN};var n=e[1],i=e[2];return{prefix:n,unit:e[3],value:parseFloat(i)}}(t),i=n.value,r=n.unit;if(l(e)){var o=e[r];if(o){if(typeof o===s)return o(i);if(a[r])return a[r](i,o)}}else if("%"===r)return i*e/100;return a[r]?a[r](i):i}function X(t,e,n){return Math.max(e,Math.min(t,n))}function u(t,e){t.classList?t.classList.add(e):t.className+=" "+e}function Y(t,e,n,i){t.addEventListener(e,n,i)}function T(t,e,n,i){t.removeEventListener(e,n,i)}var f=function(){return(f=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};var n=function(){function t(){this._events={}}var e=t.prototype;return e.on=function(t,e){if(l(t))for(var n in t)this.on(n,t[n]);else this._addEvent(t,e,{});return this},e.off=function(t,e){if(t)if(l(t))for(var n in t)this.off(n);else{var i,r;e?!(i=this._events[t])||-1<(r=c(i,function(t){return t.listener===e}))&&i.splice(r,1):this._events[t]=[]}else this._events={};return this},e.once=function(e,t){var n=this;return t&&this._addEvent(e,t,{once:!0}),new Promise(function(t){n._addEvent(e,t,{once:!0})})},e.emit=function(e,n){var i=this;void 0===n&&(n={});var t=this._events[e];if(!e||!t)return!0;var r=!1;return n.eventType=e,n.stop=function(){r=!0},n.currentTarget=this,function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var i=Array(t),r=0,e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}(t).forEach(function(t){t.listener(n),t.once&&i.off(e,t.listener)}),!r},e.trigger=function(t,e){return void 0===e&&(e={}),this.emit(t,e)},e._addEvent=function(t,e,n){var i=this._events;i[t]=i[t]||[],i[t].push(f({listener:e},n))},t}(),g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};var P=function(){return(P=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function p(t){return 180*(e=[t[0].clientX,t[0].clientY],n=[t[1].clientX,t[1].clientY],i=n[0]-e[0],r=n[1]-e[1],(0<=(o=Math.atan2(r,i))?o:o+2*Math.PI)/Math.PI);var e,n,i,r,o}function M(t){return t?t.touches?function(t){for(var e=Math.min(t.length,2),n=[],i=0;i<e;++i)n.push(m(t[i]));return n}(t.touches):[m(t)]:[]}function d(t,e,n){var i=n.length,r=w(t,i),o=r.clientX,s=r.clientY,a=r.originalClientX,l=r.originalClientY,c=w(e,i),h=c.clientX,u=c.clientY,f=w(n,i);return{clientX:a,clientY:l,deltaX:o-h,deltaY:s-u,distX:o-f.clientX,distY:s-f.clientY}}function v(t){return Math.sqrt(Math.pow(t[0].clientX-t[1].clientX,2)+Math.pow(t[0].clientY-t[1].clientY,2))}function m(t){return{clientX:t.clientX,clientY:t.clientY}}function w(t,e){void 0===e&&(e=t.length);for(var n={clientX:0,clientY:0,originalClientX:0,originalClientY:0},i=0;i<e;++i){var r=t[i];n.originalClientX+="originalClientX"in r?r.originalClientX:r.clientX,n.originalClientY+="originalClientY"in r?r.originalClientY:r.clientY,n.clientX+=r.clientX,n.clientY+=r.clientY}return e?{clientX:n.clientX/e,clientY:n.clientY/e,originalClientX:n.originalClientX/e,originalClientY:n.originalClientY/e}:n}var O=function(){function t(t){this.prevClients=[],this.startClients=[],this.movement=0,this.length=0,this.startClients=t,this.prevClients=t,this.length=t.length}var e=t.prototype;return e.getAngle=function(t){return void 0===t&&(t=this.prevClients),p(t)},e.getRotation=function(t){return void 0===t&&(t=this.prevClients),p(t)-p(this.startClients)},e.getPosition=function(t,e){void 0===t&&(t=this.prevClients);var n=d(t||this.prevClients,this.prevClients,this.startClients),i=n.deltaX,r=n.deltaY;return this.movement+=Math.sqrt(i*i+r*r),this.prevClients=t,n},e.getPositions=function(n){void 0===n&&(n=this.prevClients);var i=this.prevClients;return this.startClients.map(function(t,e){return d([n[e]],[i[e]],[t])})},e.getMovement=function(t){var e=this.movement;if(!t)return e;var n=w(t,this.length),i=w(this.prevClients,this.length),r=n.clientX-i.clientX,o=n.clientY-i.clientY;return Math.sqrt(r*r+o*o)+e},e.getDistance=function(t){return void 0===t&&(t=this.prevClients),v(t)},e.getScale=function(t){return void 0===t&&(t=this.prevClients),v(t)/v(this.startClients)},e.move=function(e,n){this.startClients.forEach(function(t){t.clientX-=e,t.clientY-=n})},t}(),R=["textarea","input"],b=function(l){function t(){this.constructor=e}var e,n;function i(t,e){void 0===e&&(e={});var S=l.call(this)||this;S.options={},S.flag=!1,S.pinchFlag=!1,S.datas={},S.isDrag=!1,S.isPinch=!1,S.isMouse=!1,S.isTouch=!1,S.clientStores=[],S.targets=[],S.prevTime=0,S.doubleFlag=!1,S._dragFlag=!1,S._isMouseEvent=!1,S.onDragStart=function(t,e){if(void 0===e&&(e=!0),S.flag||!1!==t.cancelable){var n,i=S.options,r=i.container,o=i.pinchOutside,s=i.preventWheelClick,a=i.preventRightClick,l=i.preventDefault,c=i.checkInput,h=S.isTouch,u=!S.flag;if(s&&(2===t.which||1===t.button)||a&&(3===t.which||2===t.button))return S.initDrag(),!1;if(u){var f,g=document.activeElement,p=t.target,d=p.tagName.toLowerCase(),v=-1<R.indexOf(d),m=p.isContentEditable;if(v||m){if(c||g===p)return!1;if(g&&m&&g.isContentEditable&&g.contains(p))return!1}else{(l||"touchstart"===t.type)&&g&&(f=g.tagName,(g.isContentEditable||-1<R.indexOf(f))&&g.blur())}S.clientStores=[new O(M(t))],S.flag=!0,S.isDrag=!1,S._dragFlag=!0,S.datas={},S.doubleFlag=D()-S.prevTime<200,S._isMouseEvent=(n=t)&&(-1<n.type.indexOf("mouse")||"button"in n||"which"in n),!1===S.emit("dragStart",P(P({datas:S.datas,inputEvent:t,isMouseEvent:S._isMouseEvent,isTrusted:e,isDouble:S.doubleFlag},S.getCurrentStore().getPosition()),{preventDefault:function(){t.preventDefault()},preventDrag:function(){S._dragFlag=!1}}))&&S.initDrag(),S.flag&&l&&t.preventDefault()}if(!S.flag)return!1;var w,b=0;if(u&&h&&o&&(b=setTimeout(function(){Y(r,"touchstart",S.onDragStart,{passive:!1})})),!u&&h&&o&&T(r,"touchstart",S.onDragStart),S.flag&&((w=t).touches&&2<=w.touches.length)){if(clearTimeout(b),u&&t.touches.length!==t.changedTouches.length)return;S.pinchFlag||S.onPinchStart(t)}}},S.onDrag=function(t,e){if(S.flag){var n=M(t),i=S.moveClients(n,t,!1);if(S._dragFlag){if(S.pinchFlag||i.deltaX||i.deltaY)if(!1===S.emit("drag",P(P({},i),{isScroll:!!e,inputEvent:t})))return void S.stop();S.pinchFlag&&S.onPinch(t,n)}S.getCurrentStore().getPosition(n,!0)}},S.onDragEnd=function(t){var e,n,i,r,o,s,a;S.flag&&(n=(e=S.options).pinchOutside,i=e.container,S.isTouch&&n&&T(i,"touchstart",S.onDragStart),S.pinchFlag&&S.onPinchEnd(t),0!==(r=null!=t&&t.touches?M(t):[]).length&&S.options.keepDragging?S._addStore(new O(r)):S.flag=!1,o=S._getPosition(),s=D(),a=!S.isDrag&&S.doubleFlag,S.prevTime=S.isDrag||a?0:s,S.flag||(S.emit("dragEnd",P({datas:S.datas,isDouble:a,isDrag:S.isDrag,isClick:!S.isDrag,isMouseEvent:S._isMouseEvent,inputEvent:t},o)),S.clientStores=[]))},S.onBlur=function(){S.onDragEnd()};var n=[].concat(t);S.options=P({checkInput:!1,container:1<n.length?window:n[0],preventRightClick:!0,preventWheelClick:!0,preventDefault:!0,checkWindowBlur:!1,keepDragging:!1,pinchThreshold:0,events:["touch","mouse"]},e);var i,r=S.options,o=r.container,s=r.events,a=r.checkWindowBlur;return S.isTouch=-1<s.indexOf("touch"),S.isMouse=-1<s.indexOf("mouse"),S.targets=n,S.isMouse&&(n.forEach(function(t){Y(t,"mousedown",S.onDragStart)}),Y(o,"mousemove",S.onDrag),Y(o,"mouseup",S.onDragEnd),Y(o,"contextmenu",S.onDragEnd)),a&&Y(window,"blur",S.onBlur),S.isTouch&&(i={passive:!1},n.forEach(function(t){Y(t,"touchstart",S.onDragStart,i)}),Y(o,"touchmove",S.onDrag,i),Y(o,"touchend",S.onDragEnd,i),Y(o,"touchcancel",S.onDragEnd,i)),S}g(e=i,n=l),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t);var r=i.prototype;return r.stop=function(){this.isDrag=!1,this.flag=!1,this.clientStores=[],this.datas={}},r.getMovement=function(t){return this.getCurrentStore().getMovement(t)+this.clientStores.slice(1).reduce(function(t,e){return t+e.movement},0)},r.isDragging=function(){return this.isDrag},r.isFlag=function(){return this.flag},r.isPinchFlag=function(){return this.pinchFlag},r.isDoubleFlag=function(){return this.doubleFlag},r.isPinching=function(){return this.isPinch},r.scrollBy=function(t,e,n,i){void 0===i&&(i=!0),this.flag&&(this.clientStores[0].move(t,e),i&&this.onDrag(n,!0))},r.move=function(t,e){var i=t[0],r=t[1],n=this.getCurrentStore().prevClients;return this.moveClients(n.map(function(t){var e=t.clientX,n=t.clientY;return{clientX:e+i,clientY:n+r,originalClientX:e,originalClientY:n}}),e,!0)},r.triggerDragStart=function(t){this.onDragStart(t,!1)},r.setEventDatas=function(t){var e=this.datas;for(var n in t)e[n]=t[n];return this},r.getCurrentEvent=function(t){return P(P({datas:this.datas},this._getPosition()),{movement:this.getMovement(),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,inputEvent:t})},r.getEventDatas=function(){return this.datas},r.unset=function(){var e=this,t=this.targets,n=this.options.container;this.off(),T(window,"blur",this.onBlur),this.isMouse&&(t.forEach(function(t){T(t,"mousedown",e.onDragStart)}),T(n,"mousemove",this.onDrag),T(n,"mouseup",this.onDragEnd),T(n,"contextmenu",this.onDragEnd)),this.isTouch&&(t.forEach(function(t){T(t,"touchstart",e.onDragStart)}),T(n,"touchstart",this.onDragStart),T(n,"touchmove",this.onDrag),T(n,"touchend",this.onDragEnd),T(n,"touchcancel",this.onDragEnd))},r.onPinchStart=function(t){var e,n=this.options.pinchThreshold;this.isDrag&&this.getMovement()>n||(e=new O(M(t)),this.pinchFlag=!0,this._addStore(e),!1===this.emit("pinchStart",P(P({datas:this.datas,angle:e.getAngle(),touches:this.getCurrentStore().getPositions()},e.getPosition()),{inputEvent:t}))&&(this.pinchFlag=!1))},r.onPinch=function(t,e){var n;!this.flag||!this.pinchFlag||e.length<2||(n=this.getCurrentStore(),this.isPinch=!0,this.emit("pinch",P(P({datas:this.datas,movement:this.getMovement(e),angle:n.getAngle(e),rotation:n.getRotation(e),touches:n.getPositions(e),scale:n.getScale(e),distance:n.getDistance(e)},n.getPosition(e)),{inputEvent:t})))},r.onPinchEnd=function(t){var e,n;this.pinchFlag&&(e=this.isPinch,this.isPinch=!1,this.pinchFlag=!1,n=this.getCurrentStore(),this.emit("pinchEnd",P(P({datas:this.datas,isPinch:e,touches:n.getPositions()},n.getPosition()),{inputEvent:t})))},r.initDrag=function(){this.clientStores=[],this.pinchFlag=!1,this.doubleFlag=!1,this.prevTime=0,this.flag=!1},r.getCurrentStore=function(){return this.clientStores[0]},r.moveClients=function(t,e,n){var i=this._getPosition(t,n);return(i.deltaX||i.deltaY)&&(this.isDrag=!0),P(P({datas:this.datas},i),{movement:this.getMovement(t),isDrag:this.isDrag,isPinch:this.isPinch,isScroll:!1,isMouseEvent:this._isMouseEvent,inputEvent:e})},r._addStore=function(t){this.clientStores.splice(0,0,t)},r._getPosition=function(t,e){var n=this.getCurrentStore().getPosition(t,e),i=this.clientStores.slice(1).reduce(function(t,e){var n=e.getPosition();return t.distX+=n.distX,t.distY+=n.distY,t},n),r=i.distX,o=i.distY;return P(P({},n),{distX:r,distY:o})},i}(n);var S=function(t){for(var e=5381,n=t.length;n;)e=33*e^t.charCodeAt(--n);return e>>>0};function A(i,t,e){return e.original?t:t.replace(/([^};{\s}][^};{]*|^\s*){/gm,function(t,e){var n=e.trim();return(n?r(n,","):[""]).map(function(t){var e=t.trim();return 0===e.indexOf("@")?e:-1<e.indexOf(":global")?e.replace(/\:global/g,""):-1<e.indexOf(":host")?""+e.replace(/\:host/g,"."+i):e?"."+i+" "+e:"."+i}).join(", ")+" {"})}function W(t,e){for(var n=t.length,i=0;i<n;++i)if(e(t[i],i))return!0;return!1}function j(t,e){for(var n=t.length,i=0;i<n;++i)if(e(t[i],i))return t[i];return null}function F(t,e){try{return new RegExp(t,"g").exec(e)}catch(t){return null}}function L(t){return t.replace(/_/g,".")}function H(t,r){var o=null,s="-1";return W(t,function(t){var e,n,i=F("("+t.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",r);return i&&!t.brand&&(o=t,s=i[3]||"-1",t.versionAlias?s=t.versionAlias:t.versionTest&&(e=t.versionTest.toLowerCase(),n=F("("+e+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",r),s=(n?n[3]:"")||s),s=L(s),1)}),{preset:o,version:s}}function k(t,n){return j(t,function(t){var e=t.brand;return F(""+n.test,e.toLowerCase())})}var B=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],V=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",brand:!0}],N=[{test:"applewebkit",id:"webkit"}],q=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],Z=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"mac os x",id:"mac"},{test:"android",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function G(t){var e=function(t){var e=t;if(void 0===e){if("undefined"==typeof navigator||!navigator)return"";e=navigator.userAgent||""}return e.toLowerCase()}(t),n=!!/mobi/g.exec(e),i={name:"unknown",version:"-1",majorVersion:-1,webview:!!H(q,e).preset,chromium:!!H(V,e).preset,webkit:!1},r={name:"unknown",version:"-1",majorVersion:-1},o=H(B,e),s=o.preset,a=o.version,l=H(Z,e),c=l.preset,h=l.version;return i.webkit=!i.chromium&&!!H(N,e).preset,c&&(r.name=c.id,r.version=h,r.majorVersion=parseInt(h,10)),s&&(i.name=s.id,i.version=a,i.webview&&"ios"===r.name&&"safari"!==i.name&&(i.webview=!1)),i.majorVersion=parseInt(i.version,10),{browser:i,os:r,isMobile:n,isHints:!1}}var I,K,$,U,J,Q,tt,et,nt,it,rt,ot,st,at,lt,ct="safari"===(void 0===I&&function(){if("undefined"!=typeof navigator&&navigator&&navigator.userAgentData){var t=navigator.userAgentData,e=t.brands||t.uaList;return e&&e.length}}()?(J=navigator.userAgentData,Q=(J.uaList||J.brands).slice(),tt=J.mobile||!1,et=Q[0],nt={name:et.brand,version:et.version,majorVersion:-1,webkit:!1,webview:W(q,function(t){return k(Q,t)}),chromium:W(V,function(t){return k(Q,t)})},it={name:"unknown",version:"-1",majorVersion:-1},nt.webkit=!nt.chromium&&W(N,function(t){return k(Q,t)}),K&&($=K.platform.toLowerCase(),U=j(Z,function(t){return new RegExp(""+t.test,"g").exec($)}),it.name=U?U.id:$,it.version=K.platformVersion),W(B,function(t){var e=k(Q,t);return e&&(nt.name=t.id,nt.version=K?K.uaFullVersion:e.version,1)}),"Linux armv8l"===navigator.platform?it.name="android":nt.webkit&&(it.name=tt?"ios":"mac"),"ios"===it.name&&nt.webview&&(nt.version="-1"),it.version=L(it.version),nt.version=L(nt.version),it.majorVersion=parseInt(it.version,10),nt.majorVersion=parseInt(nt.version,10),{browser:nt,os:it,isMobile:tt,isHints:!0}):G(I)).browser.name,ht="infinite-viewer-",ut="".concat(ht,"wrapper"),ft="".concat(ht,"scroll-area"),gt="".concat(ht,"scroll-bar"),pt="".concat(ht,"horizontal-scroll-bar"),dt="".concat(ht,"vertical-scroll-bar"),vt="".concat(ht,"scroll-thumb"),mt=(lt=ht,rt="\n{\n    position: relative;\n    overscroll-behavior: none;\n}\n.wrapper {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    top: 0;\n    left: 0;\n    will-change: scroll-position;\n}\n.wrapper::-webkit-scrollbar {\n    display: none;\n}\n.scroll-area {\n    position:absolute;\n    top:0;\n    left:0;\n    transform-origin: 0 0;\n}\n.scroll-bar {\n    position:absolute;\n    width: 10px;\n    height: 10px;\n    box-sizing: border-box;\n    right: 0;\n    bottom: 0;\n    overflow: hidden;\n}\n.horizontal-scroll-bar {\n    width: 100%;\n    height: 14px;\n}\n.vertical-scroll-bar {\n    height: 100%;\n    width: 14px;\n}\n.scroll-thumb {\n    position:relative;\n    opacity: 0.7;\n    background: #333;\n    border-radius: 3px;\n    left: 0px;\n    top: 0px;\n    z-index: 10;\n    width: 6px;\n    height: 6px;\n    transition: all ease 0.2s;\n}\n.horizontal-scroll-bar .scroll-thumb {\n    margin: 4px 0px;\n    transition-property: margin, height, border-radius;\n}\n.vertical-scroll-bar .scroll-thumb {\n    margin: 0px 4px;\n    transition-property: margin, width, border-radius;\n}\n.horizontal-scroll-bar:hover .scroll-thumb {\n    height: 10px;\n    margin: 2px 0px;\n    border-radius: 5px;\n}\n.vertical-scroll-bar:hover .scroll-thumb {\n    width: 10px;\n    margin: 0px 2px;\n    border-radius: 5px;\n}\n".replace(/([^}{]*){/gm,function(t,e){return e.replace(/\.([^{,\s\d.]+)/g,"."+lt+"$1")+"{"}),{className:st="rCS"+S(rt).toString(36),inject:function(t,e){void 0===e&&(e={});var n,i,r,o,s,a,l=function(t){if(t&&t.getRootNode){var e=t.getRootNode();if(11===e.nodeType)return e}}(t),c=0===at;return(l||c)&&(i=st,r=rt,o=e,s=l,(a=document.createElement("style")).setAttribute("type","text/css"),a.setAttribute("data-styled-id",i),o.nonce&&a.setAttribute("nonce",o.nonce),a.innerHTML=A(i,r,o),(s||document.head||document.body).appendChild(a),n=a),c&&(ot=n),l||++at,{destroy:function(){l?(t.removeChild(n),n=null):(0<at&&--at,0===at&&ot&&(ot.parentNode.removeChild(ot),ot=null))}}}}),wt={margin:500,threshold:100,zoom:1,rangeX:[-1/(at=0),1/0],rangeY:[-1/0,1/0],rangeOffsetX:[0,0],rangeOffsetY:[0,0],wrapperElement:null,scrollAreaElement:null,horizontalScrollElement:null,verticalScrollElement:null,usePinch:!1,useAutoZoom:!1,useMouseDrag:!1,pinchThreshold:30,cspNonce:"",maxPinchWheel:1/0,wheelScale:.01,displayHorizontalScroll:!0,displayVerticalScroll:!0,useTransform:!0,useWheelPinch:!0,zoomRange:[.001,1/0],wheelPinchKey:"ctrl",useWheelScroll:ct,zoomOffsetX:"50%",zoomOffsetY:"50%",translateZ:0,useGesture:!0,useResizeObserver:!1},bt=mt.className,St=["margin","threshold","zoomOffsetX","zoomOffsetY","zoom","rangeX","rangeY","rangeOffsetX","rangeOffsetY","usePinch","useMouseDrag","pinchThreshold","maxPinchWheel","wheelScale","displayVerticalScroll","displayHorizontalScroll","useWheelScroll","translateZ","useAutoZoom","wheelPinchKey","zoomRange"],Et=t(t([],St,!0),["useWheel","useGesture","cspNonce","wrapperElement","scrollAreaElement","verticalScrollElement","horizontalScrollElement","useResizeObserver"],!1);function yt(t,e){var n=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return Math.abs(n/e)}function zt(t){return Math.abs(t)}function Ct(t,e,n,i,r){return[r||isFinite(n[0])?n[0]:Math.min(-1,Math.floor(t/e))*e-i,r||isFinite(n[1])?n[1]:Math.max(1,Math.ceil(t/e))*e+i]}var Dt=function(r){function t(t,e){var a=r.call(this)||this;a.type=t,a.isAppend=!1,a.pos=0,a.size=0,a.scrollSize=0,a.isHorizontal=!1,a.onWheel=function(t){var e=a.isHorizontal?t.deltaX:t.deltaY;e&&t.preventDefault(),a.trigger("scroll",{delta:e})};var n,l="horizontal"===t,i=e;return e?n=e.querySelector(".".concat(vt)):(i=document.createElement("div"),n=document.createElement("div"),i.insertBefore(n,null),a.isAppend=!0),u(i,l?pt:dt),u(i,gt),u(n,vt),a.thumbElement=n,a.barElement=i,a.isHorizontal=l,a.gesto=new b(i,{container:window}).on("dragStart",function(s){var t=s.inputEvent.target,e=s.datas,n=a.thumbElement===t;n||setTimeout(function(){requestAnimationFrame(function(){var t,e,n=a.thumbElement.getBoundingClientRect(),i=n[l?"left":"top"],r=i+n[l?"width":"height"],o=s[l?"clientX":"clientY"];i<=o&&o<=r||(e=(t=a.size)*t/a.scrollSize,a.scrollBy(i<o?e:-e))})},100),e.isThumb=n,s.inputEvent.stopPropagation(),s.inputEvent.preventDefault()}).on("drag",function(t){t.datas.isThumb&&a.scrollBy(a.isHorizontal?t.deltaX:t.deltaY)}),Y(a.barElement,"wheel",a.onWheel,{passive:!1}),a}o(t,r);var e=t.prototype;return e.scrollBy=function(t){var e=t/this.size;this.trigger("scroll",{delta:this.scrollSize*e})},e.render=function(t,e,n,i){this.pos=e,this.size=n,this.scrollSize=i;var r=t&&n<i?"block":"none",o=this.isHorizontal?["X","width"]:["Y","height"],s=o[0],a=o[1];this.barElement.style.cssText="display: ".concat(r,";"),this.thumbElement.style.cssText+="".concat(a,": ").concat(n*n/i,"px;")+"transform: translate".concat(s,"(").concat(e/i*n,"px)")},e.destroy=function(){T(this.barElement,"wheel",this.onWheel),this.gesto.off(),this.off()},t}(n),xt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e}(function(i){function t(t,e,n){void 0===n&&(n={});var u=i.call(this)||this;return u.containerElement=t,u.viewportElement=e,u.offsetX=0,u.offsetY=0,u.containerWidth=0,u.containerHeight=0,u.viewportWidth=0,u.viewportHeight=0,u.scrollLeft=0,u.scrollTop=0,u.timer=0,u.dragFlag=!1,u.isLoop=!1,u._tempScale=1,u._tempRect=null,u._tempRectTimer=null,u._onDestroys=[],u.resize=function(){var t=u.containerElement,e=t.offsetWidth,n=t.offsetHeight,i=u.viewportElement,r=i.offsetWidth,o=i.offsetHeight;u.containerWidth=e,u.containerHeight=n,u.viewportWidth=r,u.viewportHeight=o},u.onScroll=function(){var t=u.wrapperElement,e=t.scrollLeft,n=t.scrollTop,i=u.zoom,r=void 0===i?wt.zoom:i,o=e-u.scrollLeft,s=n-u.scrollTop,a=u.getScrollLeft(),l=u.getScrollTop();u.isLoop&&(u.isLoop=!1),u.scrollLeft=e,u.scrollTop=n,u.scrollTo(a+o/r,l+s/r)},u.onWheel=function(t){var e=u.options,n=e.maxPinchWheel||1/0,i=t["".concat(u.wheelPinchKey,"Key")];if(e.useWheelPinch&&i){var r=0<=(h=t.deltaY)?1:-1,o=Math.min(n,Math.abs(h)),s=-(h=r*o),a=Math.max(1+s*(e.wheelScale||.01),1e-6);clearTimeout(u._tempRectTimer),u._tempRectTimer=window.setTimeout(function(){u._tempRect=null},100),u._triggerPinch({distance:o,scale:a,rotation:0,zoom:u.zoom*a,inputEvent:t,isWheel:!0,clientX:t.clientX,clientY:t.clientY,ratioX:0,ratioY:0})}else{if(!e.useWheelScroll)return;var l=u.zoom,c=t.deltaX,h=t.deltaY;t.shiftKey&&!c&&(c=h,h=0),u.scrollBy(c/l,h/l)}t.preventDefault()},u.onGestureStart=function(t){u._tempScale=u.zoom,u._setClientRect(),t.preventDefault()},u.onGestureChange=function(t){var e;t.preventDefault(),!u.gesto.isFlag()&&u._tempScale?(e=t.scale,u._triggerPinch({distance:0,scale:e,rotation:t.rotation,inputEvent:t,isWheel:!0,zoom:u._tempScale*e,clientX:t.clientX,clientY:t.clientY,ratioX:0,ratioY:0})):u._tempScale=0},u.onGestureEnd=function(){},u.options=h(h({},wt),n),u.init(),u}o(t,i);var n,r,e=t.prototype;return e.getContainer=function(){return this.containerElement},e.getViewport=function(){return this.viewportElement},e.getWrapper=function(){return this.wrapperElement},e.geScrollArea=function(){return this.scrollAreaElement},e.destroy=function(){this.off(),this.gesto.unset(),this.verticalScrollbar.destroy(),this.horizontalScrollbar.destroy(),this.injectResult.destroy();var t=this.containerElement;this._onDestroys.forEach(function(t){t()}),T(this.wrapperElement,"scroll",this.onScroll),T(t,"wheel",this.onWheel),T(t,"gesturestart",this.onGestureStart),T(t,"gesturechange",this.onGestureChange),T(t,"gesturesend",this.onGestureEnd),this.gesto=null,this.injectResult=null,this.containerElement=null,this.viewportElement=null,this.options=null},e.getScrollTop=function(t){return this.scrollTop/this.zoom+this.offsetY+(t?zt(this.getRangeY()[0]):0)},e.getScrollLeft=function(t){return this.scrollLeft/this.zoom+this.offsetX+(t?zt(this.getRangeX()[0]):0)},e.getScrollWidth=function(t){var e=this.getRangeX(t);return this.containerWidth+zt(e[0])+zt(e[1])},e.getScrollHeight=function(t){var e=this.getRangeY(t);return this.containerHeight+zt(e[0])+zt(e[1])},e.scrollCenter=function(){this.resize();var t=this.zoom,e=-(this.containerWidth/t-this.viewportWidth)/2,n=-(this.containerHeight/t-this.viewportHeight)/2;return this.scrollTo(e,n)},e.scrollBy=function(t,e){return this.scrollTo(this.getScrollLeft()+t,this.getScrollTop()+e)},e.scrollTo=function(t,e){var n,i,r=this,o=this,s=o.zoom,a=void 0===s?wt.zoom:s,l=o.margin,c=void 0===l?wt.margin:l,h=o.threshold,u=void 0===h?wt.threshold:h,f=o.scrollLeft,g=o.scrollTop,p=this.getRangeX(!0,!0),d=p[0],v=p[1],m=this.getRangeY(!0,!0),w=m[0],b=m[1],S=Math.round(f),E=Math.round(g),y=this.getScrollAreaWidth(),z=this.getScrollAreaHeight(),C=t*a,D=e*a;C-u<=d?(S=n=Math.max(0,C-d),t=(d+n)/a):v<=C+u?(i=Math.max(0,v-C),S=y-i,t=(v-i)/a):S<u?S+=c:y-u<S&&(S-=c),D-u<=w?(E=n=Math.max(0,D-w),e=(w+n)/a):b<=D+u?(i=Math.max(0,b-D),E=z-i,e=(b-i)/a):E<u?E+=c:z-u<E&&(E-=c),S=Math.round(S),E=Math.round(E),this.scrollLeft=S,this.scrollTop=E,this.offsetX=Math.round(t-S/a),this.offsetY=Math.round(e-E/a),this.render();var x=this.getScrollLeft(),_=this.getScrollTop();return this.trigger("scroll",{scrollLeft:x,scrollTop:_}),Math.round(f)===S&&Math.round(g)===E||(this.isLoop=!0,this.move(S,E),requestAnimationFrame(function(){var t,e,n;r.isLoop&&(r.isLoop=!1,e=(t=r.wrapperElement).scrollLeft,n=t.scrollTop,r.scrollLeft=e,r.scrollTop=n,S===Math.round(e)&&E===Math.round(n)||r.scrollTo(x,_))}),!1)},e.setZoom=function(t,e){var n,i,r,o,s,a,l,c,h,u,f,g,p,d,v,m,w,b,S;e&&this.useAutoZoom||(n=this.containerWidth,i=this.containerHeight,r=this.zoom,o=this.zoomRange,a=void 0===(s=this.zoomOffsetX)?wt.zoomOffsetX:s,c=void 0===(l=this.zoomOffsetY)?wt.zoomOffsetY:l,h=this.getScrollLeft(),u=this.getScrollTop(),f=X(t,o[0],o[1]),this.options.zoom=f,g=this.getScrollLeft(),p=this.getScrollTop(),m=h+(d=_("".concat(a),n))/r,w=u+(v=_("".concat(c),i))/r,b=g+d/f,S=p+v/f,this.scrollBy(m-b,w-S),this.render())},e.getRangeX=function(t,e){var n=this,i=n.rangeX,r=void 0===i?wt.rangeX:i,o=n.rangeOffsetX,s=void 0===o?wt.rangeOffsetX:o,a=n.margin,l=void 0===a?wt.margin:a,c=n.zoom,h=void 0===c?wt.zoom:c,u=n.threshold,f=Ct(this.getScrollLeft(),l,r,u,e);return t?[f[0]*h+s[0],Math.max(this.viewportWidth*h-this.containerWidth,f[1]*h+s[1])]:[f[0]+s[0],f[1]+s[1]]},e.getRangeY=function(t,e){var n=this.rangeY,i=void 0===n?wt.rangeY:n,r=this.margin,o=void 0===r?wt.margin:r,s=this.zoom,a=void 0===s?wt.zoom:s,l=this.threshold,c=Ct(this.getScrollTop(),o,i,l,e);return t?[c[0]*a,Math.max(this.viewportHeight*a-this.containerHeight,c[1]*a)]:c},e.init=function(){var t,o=this,e=this.containerElement,n=this.options,i=n.wrapperElement||e.querySelector(".".concat(ut)),r=n.scrollAreaElement||e.querySelector(".".concat(ft)),s=n.horizontalScrollElement||e.querySelector(".".concat(pt)),a=n.verticalScrollElement||e.querySelector(".".concat(dt));i||((i=document.createElement("div")).insertBefore(this.viewportElement,null),e.insertBefore(i,null)),this.wrapperElement=i,r||(r=document.createElement("div"),i.insertBefore(r,i.firstChild)),this.scrollAreaElement=r,u(e,bt),u(i,ut),u(r,ft),this.horizontalScrollbar=new Dt("horizontal",s),this.verticalScrollbar=new Dt("vertical",a),this.horizontalScrollbar.on("scroll",function(t){o.scrollBy(t.delta/o.zoom,0)}),this.verticalScrollbar.on("scroll",function(t){o.scrollBy(0,t.delta/o.zoom)}),this.horizontalScrollbar.isAppend&&e.insertBefore(this.horizontalScrollbar.barElement,null),this.verticalScrollbar.isAppend&&e.insertBefore(this.verticalScrollbar.barElement,null),this.injectResult=mt.inject(e,{nonce:this.options.cspNonce}),this.gesto=new b(e,{container:document.body,events:["touch","mouse"]}).on("dragStart",function(t){var e=t.inputEvent,n=t.datas,i=t.stop,r=t.isMouseEvent;o.useMouseDrag||!r?(o.pauseAnimation(),(o.dragFlag=!1)!==o.trigger("dragStart",{inputEvent:e})?(e.preventDefault(),n.startEvent=e):i()):i()}).on("drag",function(t){var e;!o.options.usePinch||t.isPinch?(o.trigger("drag",h(h({},t),{inputEvent:t.inputEvent})),function(t){var e=t.deltaX,n=t.deltaY,i=t.datas,r=Date.now(),o=i.speed;if(!o)return i.speed=[0,0],i.time=r;var s=r-i.time;i.speed=[o[0]/2+e/s,o[1]/2+n/s]}(t),e=o.zoom,o.scrollBy(-t.deltaX/e,-t.deltaY/e)):!o.dragFlag&&t.movement>n.pinchThreshold&&(o.dragFlag=!0,o.trigger("abortPinch",{inputEvent:t.datas.startEvent||t.inputEvent}))}).on("dragEnd",function(t){o.trigger("dragEnd",{isDrag:t.isDrag,isDouble:t.isDouble,inputEvent:t.inputEvent}),o.startAnimation(t.datas.speed)}).on("pinchStart",function(t){var e=t.inputEvent,n=t.datas,i=t.stop;e.preventDefault(),o.pauseAnimation(),n.startZoom=o.zoom,!1===o.trigger("pinchStart",{inputEvent:e})&&i(),o._setClientRect()}).on("pinch",function(t){o._triggerPinch({rotation:t.rotation,distance:t.distance,scale:t.scale,inputEvent:t.inputEvent,isWheel:!1,zoom:t.datas.startZoom*t.scale,clientX:t.clientX,clientY:t.clientY,ratioX:0,ratioY:0})}).on("pinchEnd",function(){o._tempRect=null}),Y(i,"scroll",this.onScroll),n.useResizeObserver?((t=new ResizeObserver(function(){o.resize()})).observe(this.viewportElement),t.observe(this.containerElement),this._onDestroys.push(function(){t.disconnect()})):(Y(window,"resize",this.resize),this._onDestroys.push(function(){T(window,"resize",o.resize)})),(n.useWheelPinch||n.useWheelScroll)&&Y(e,"wheel",this.onWheel,{passive:!1}),n.useGesture&&(Y(e,"gesturestart",this.onGestureStart,{passive:!1}),Y(e,"gesturechange",this.onGestureChange,{passive:!1})),this.resize(),this.render(),this.scrollTo(0,0)},e.render=function(){var t=this.offsetX,e=this.offsetY,n=this.zoom,i=void 0===n?wt.zoom:n,r=this.translateZ,o=void 0===r?0:r,s=this.options.useTransform,a=void 0===s?wt.useTransform:s,l=-t*i,c=-e*i;this.scrollAreaElement.style.cssText="width:calc(100% + ".concat(this.getScrollAreaWidth(),"px);")+"height:calc(100% + ".concat(this.getScrollAreaHeight(),"px);");var h=this.viewportElement.style;h.cssText+=!1===a?"position: relative; top: ".concat(c,"px; left: ").concat(l,"px;"):"transform-origin: 0 0;transform:translate3d(".concat(l,"px, ").concat(c,"px, ").concat(o,"px) scale(").concat(i,");"),this.renderScroll()},e.renderScroll=function(){var t=this.containerWidth,e=this.containerHeight,n=this.zoom,i=this.getScrollLeft(!0)*n,r=this.getScrollTop(!0)*n,o=this.getScrollWidth(!0),s=this.getScrollHeight(!0);this.horizontalScrollbar.render(this.displayHorizontalScroll,i,t,o),this.verticalScrollbar.render(this.displayVerticalScroll,r,e,s)},e.move=function(t,e){var n=this.wrapperElement;n.scrollLeft=t,n.scrollTop=e},e.startAnimation=function(t){var r,o,s,e,n,a,l,c,h=this;t&&(t[0]||t[1])&&(r=function(t){return 1-Math.pow(1-t,3)},o=yt(t,-6e-4),n=yt(e=t,-6e-4),s=[e[0]/2*n,e[1]/2*n],a=Date.now(),l=a,c=function(){var t=Date.now(),e=t-a;o<e&&(e=o);var n=r(e/o),i=r((l-a)/o);l=t,h.scrollBy(-s[0]*(n-i),-s[1]*(n-i)),o<=e||(h.timer=requestAnimationFrame(c))},this.timer=requestAnimationFrame(c))},e.pauseAnimation=function(){cancelAnimationFrame(this.timer)},e.getScrollAreaWidth=function(){var t=this.getRangeX(!0),e=t[0],n=t[1];return e||n?2*this.margin:0},e.getScrollAreaHeight=function(){var t=this.getRangeY(!0),e=t[0],n=t[1];return e||n?2*this.margin:0},e._triggerPinch=function(t){var e=t.clientX,n=t.clientY,i=t.zoom;this.useAutoZoom&&this._zoomByClient(t.zoom,e,n),this._tempRect||this._setClientRect();var r=this.zoomRange,o=this._tempRect,s=o.left,a=o.top,l=(e-s)/o.width*100,c=(n-a)/o.height*100;this.trigger("pinch",h(h({},t),{zoom:X(i,r[0],r[1]),ratioX:l,ratioY:c}))},e._setClientRect=function(){var t=this.getContainer().getBoundingClientRect();this._tempRect={left:t.left,top:t.top,width:t.width,height:t.height}},e._zoomByClient=function(t,e,n){this._tempRect||this._setClientRect();var i=this._tempRect,r=i.left,o=i.top,s=i.width,a=i.height,l=this.options,c=l.zoomOffsetX,h=l.zoomOffsetY;l.zoomOffsetX="".concat((e-r)/s*100,"%"),l.zoomOffsetY="".concat((n-o)/a*100,"%"),this.setZoom(t),l.zoomOffsetX=c,l.zoomOffsetY=h},function(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;0<=a;a--)(r=t[a])&&(s=(o<3?r(s):3<o?r(e,n,s):r(e,n))||s);return 3<o&&s&&Object.defineProperty(e,n,s),s}([(n=St,r=function(t,e){var n={enumerable:!0,configurable:!0,get:function(){return this.options[e]}},i="set ".concat(e).replace(/[\s-_]([a-z])/g,function(t,e){return e.toUpperCase()});t[i]?n.set=function(t){this[i](t,!0)}:n.set=function(t){this.options[e]=t},Object.defineProperty(t,e,n)},function(t){var e=t.prototype;n.forEach(function(t){r(e,t)})})],t)}(n)),_t={__proto__:null,default:xt,OPTIONS:Et,PROPERTIES:St,EVENTS:["scroll","abortPinch","dragStart","dragEnd","pinchStart","pinch"],METHODS:["getScrollLeft","getScrollTop","getScrollWidth","getScrollHeight","scrollTo","scrollBy","scrollCenter","getContainer","getViewport","getWrapper","setZoom","getRangeX","getRangeY","resize"],CLASS_NAME:bt};for(var Xt in _t)xt[Xt]=_t[Xt];return xt});
//# sourceMappingURL=infinite-viewer.min.js.map
